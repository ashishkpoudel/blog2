<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Sapiensworks | DDD Decoded - Entities and Value Objects Explained</title>
  <meta name="description" content="Converting tech into business advantage">
  <meta name="author" content="Mike Mogosanu">
  <meta name="twitter:card" content="summary"/>
<meta name="twitter:description" content="In-depth technical articles for developers who want to deliver more business value"/>
<meta name="twitter:title" content="SapiensWorks -  DDD Decoded - Entities and Value Objects Explained"/>
<meta name="twitter:site" content="@sapiensworks"/>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/gridlex/2.6.1/gridlex.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
 <!-- <link rel="alternate" type="application/atom+xml" title="Sapiensworks Articles" href="/feed.atom" /> -->
  <link rel="stylesheet"
  href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <link rel="stylesheet" href="/style.css">
  <script type='text/javascript' src='//platform-api.sharethis.com/js/sharethis.js#property=5a3b096e9d192f001374336b&product=sop' async='async'></script>
</head>
<body>
<header>
  <div class="grid-noGutter-middle">
    <div class="col-4_xs-12_sm-12" data-push-left="off-4_sm-0_xs-0">
      
          <h1 class="title">  <a href="/">  Sapiens Works </a> </h1>
      
      

      </div>
      
      <div class="col-3_xs-8_sm-8 text-center" data-push-left="off-1_xs-1_sm-1"><a href="https://twitter.com/sapiensworks">
        <span class="fa fa-twitter-square fa-2x"></span></a>
        <a href="https://github.com/sapiens">
        <span class="fa fa-github-square fa-2x"></span></a>
        <a href="http://stackoverflow.com/users/1017868/mikesw">
        <span class="fa fa-stack-overflow fa-2x"></span></a>
     <!--    <a href="/feed.atom">
        <span class="fa fa-rss-square fa-2x"></span></a> -->
      </div>
    
    
  </div>
  <div class="grid-middle-center-noGutter">
      <div class="col-3_xs-12_sm-12"><span class="tagline">Converting tech into business advantage</span></div>
    
    </div>
    
        <nav class="grid-center-noGutter-middle main-menu">
            
            <a href="/tags.html" class="col-1_xs-3_sm-3">
              <span>Topics</span>
            </a>
            <a href="/about.html" class="col-1_xs-3_sm-3">
              <span>About</span>
            </a>
            
         
            
          </nav>

    
    

 
  

  


  
</header>
<main>



 <article>
    <header>
      <h1>DDD Decoded - Entities and Value Objects Explained</h1>
      <div class="article-meta">
      <span>published on &nbsp; <b>29 July 2016</b></span> in <a href="/tags.html#Domain driven design">Domain driven design</a>
    </div>
    </header>
  <div class="post">
 
<p>One of the staples of DDD <em>mindset</em> is the partitioning of <strong>business concepts</strong> into: <em>Entities</em> and <em>Value Objects</em> . Notice, that I've said <em>concepts</em> not objects. The difference is that an object <em>might be</em> an implementation of a model of a concept. It's not about how we write code, it's about how we 'label' a business aspect, in a more developer friendly manner.</p>
<h1>Why do we need these tactical patterns?</h1>
<p>One practical advantage of DDD is that it tells us how to organize domain information in a way that we can implement it easier. Once we know we're dealing with an <em>Entity</em> or a <em>Value Object</em>, we get some hints about how to continue modelling or how an implementation looks like.</p>
<h1>Entities are concepts whose instances are uniquely identifiable</h1>
<p>Actually, it's a bit more: yes, they all have one <em>immutable, read-only</em> aspect or detail (call it however you wish) that acts as an identifier, but the thing with an entity is that we can change everything related to it (except its id) and it remains the same instance. It sounds a bit abstract and dry, but things are usually simple. It's quite easy to identify a concept that is an entity: the domain expert will refer to it as a single, identifiable item. <em>Customer, Invoice, Order, Article, Post</em> etc are examples of common concepts which are entities. As long as the business care about tracking each instance of that concept, we're dealing with an Entity.</p>
<p>In many cases, you get the hint directly: the domain expert will mention a <em>unique number</em> or <em>unique id</em> or <em>serial number</em> etc as being part of that concept definition. Even more, when we identify models for business cases which change the instance of that concept, we keep seeing the identification detail mentioned every time.</p>
<h2>What being an Entity tells us</h2>
<p>The most important hint is that an entity designates a 'bigger' concept, therefor we're dealing with an <a href="http://blog.sapiensworks.com/post/2016/07/14/DDD-Aggregate-Decoded-1">aggregate</a> and we need to 'dig' deeper in order to find out its <em>composition and its business rules</em>.
Another thing is an entity can't part of an aggregate of another entity. But we can have <em>references</em> (not the best word) that is, an aggregate can 'point' to another entity. Maybe a better way of saying it is that when we have a <strong>domain relationship</strong> between 2 entities and one 'needs' the other one, the expression of it is a reference a.k.a the id of the other entity.</p>
<p>An example is an Order is always placed by a Customer, so the Order entity has a relationship with the Customer concept, in the sense that we need to represent the Customer as being part of the Order (Create) aggregate. But since Customer is an Entity, only its id will be part of the Order aggregate.</p>
<h1>Value objects are simple or composite values that have a business meaning</h1>
<p>A reminder that early DDD was mixed with OOP, a better name for the <em>Value Object(VO)</em> would be a Value Concept. But the name stuck so we keep saying Value Objects even if its implementation is not an object. VOs usually are not treated with the same respect as the Entities, however they are equally important. It's not that hard to identify a VO, it's a concept that doesn't have an explicit identity detail. Actually, we can say that the identity of a VO is represented by all the values that VO has. Change something and it becomes another value.</p>
<p>VO not only have values, but they incorporate business constraints that the values needs to respect. Basically, a VO is a 'smaller' concept, which is part of a (big concept) Entity.  Most VO are small enough, 1-2 values but we can have bigger VO which combine other VOs.</p>
<p>Let's take an example: A <strong>Price</strong> is a concept which is represented by 2 values: Amount and Currency (itself a VO). It doesn't have an explicit identity and most importantly, the business doesn't differentiate between one $5 and another $5.</p>
<p>Another example is an Order's ordered product, a detail of the Order Entity. And no, I haven't seen any business talking about 'OrderLines', but they talk about an order's <em>Items</em>. The VO <code>OrderItem</code> is a composite of 3 things: <em>Product</em>, <em>Quantity</em> and <em>Price</em>. As a concept, <code>Product</code> is an entity and a VO can't contain Entities so what we'll have is a <em>ProductId</em> (or SKU) which itself is a VO. And it might seem that <code>OrderItem</code> has an identification detail, the <em>product</em>, used to identify a specific item from the order and making the item look like an entity, but the important thing is that <code>OrderItem</code> is a component of the Order, a minor concept which isn't used directly outside the Order. A business can't identify an <code>OrderItem</code> only by its 'id', it always needs the <code>Order</code> itself to act as a context for that 'id'. That's what makes it a VO, a true entity doesn't need another entity to be identifiable.</p>
<p>Sometimes is tricky to identify the nature of a concept, it might look like an entity, however if it represents a minor concept which make sense only as part of another Entity, then we're dealing with a VO.</p>
<h2>What a VO tells us</h2>
<ul>
<li>Business Constraints - a VO communicates business semantics and usually this means those values need to respect business rules. A VO is <strong>always</strong> valid.</li>
<li>Immutability - due to its nature, a VO never changes. It can't change or else it becomes another value. So, set its value(s) once and that's it.</li>
<li>Usually a component of an aggregate - Business functionality deals with Entities, it doesn't care about a stand-alone VO instance. Ideally, all components of an aggregate are VOs.</li>
<li>Semantics &gt; Structure - <code>Price</code> has an amount and a currency. <code>Discount</code> has an amount and a currency. Are they the same concept? No, and the business cares about that. Even if 2 VOs have identical structure and business constraints they aren't the same and they should be implemented as different things. DRY doesn't apply here, never reuse VOs!</li>
</ul>
<p>These hints make it easy for us to implement a VO and personally I go for an object with business rules enforced in the constructor plus getters. We can have methods but those methods should never change the VO, you can only create new VOs.</p>
<p>In some cases, the VO implementation can be just a simple enum (think OrderStatus: Pending - InProgress - Completed), no need to complicate our life.</p>
<h1>When CQRS is involved</h1>
<p>While the nature of a concept is the same, regardless if it's a Command or a Query, these patterns make sense only for the Command model. A query model is just some (read-only)data which can span multiple concepts. While we can use some VO for queries, it's mainly a DRY convenience.</p>
<h1>Conclusion</h1>
<p>It helps to organize the business concepts using these tactical patterns, as long as we identify things <em>properly</em>. The most common mistake I see is devs who point to a data structure full of primitive types and say:&quot;I have this Entity&quot;. Do not confuse the nature of a concept with a possible implementation of one of its command models.</p>

 </div>
 <footer>
   <div class="sharethis-inline-share-buttons"></div>

 <a class="previous" href="/post/2016/07/23/DDD-Eventual-Consistency">&laquo; Previous</a> 
 <a class="next" href="/post/2016/08/12/DDD-Bounded-Contexts-Explained">Next &raquo;</a>    
 </footer>
  </article>;

  <section id="comments">
  
      <div class="comments">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
      
            var disqus_shortname = 'sapiensworks';
      
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
      
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      </div>
      
        </section>
</main>
<footer>
    © 2018 SapiensWorks.com 
</footer>
<script>hljs.initHighlightingOnLoad();</script>
<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-2037614-18', 'auto');
		ga('send', 'pageview', {
		  'page': '/',
		  'title': ''
		});
	</script>
	<!-- End Google Analytics -->
</body>
</html>